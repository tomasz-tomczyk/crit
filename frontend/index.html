<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crit</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="theme.css">
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="header">
  <div class="header-left">
    <span class="header-title">Crit</span>
    <span class="header-context" id="branchContext" style="display:none">
      <span class="branch-icon">
        <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M11.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5zm-2.25.75a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.492 2.492 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25zM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5zM3.5 3.25a.75.75 0 1 1 1.5 0 .75.75 0 0 1-1.5 0z"/></svg>
      </span>
      <span id="branchName"></span>
    </span>
    <span class="header-notify" id="headerNotify"></span>
    <span class="header-update" id="headerUpdate" style="display:none">
      <a id="updateLink" href="https://github.com/tomasz-tomczyk/crit/releases/latest" target="_blank" rel="noopener noreferrer"></a>
      <button class="header-update-dismiss" onclick="dismissUpdate()" title="Dismiss">&#x2715;</button>
    </span>
  </div>
  <div class="header-right">
    <span class="viewed-count" id="viewedCount"></span>
    <span class="comment-count" id="commentCount"></span>
    <div class="diff-mode-toggle" id="diffModeToggle" style="display:none">
      <button class="toggle-btn active" data-mode="split" title="Split diff">Split</button>
      <button class="toggle-btn" data-mode="unified" title="Unified diff">Unified</button>
    </div>
    <button class="theme-toggle" id="shortcutsToggle" title="Keyboard shortcuts (?)" aria-label="Keyboard shortcuts">?</button>
    <button class="theme-toggle" id="tocToggle" title="Table of contents" aria-label="Table of contents">&#9776;</button>
    <div class="theme-pill" role="group" aria-label="Theme">
      <div class="theme-pill-indicator"></div>
      <button class="theme-pill-btn" data-for-theme="system" title="System theme" role="radio" aria-label="System theme">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M2 4.25A2.25 2.25 0 0 1 4.25 2h7.5A2.25 2.25 0 0 1 14 4.25v5.5A2.25 2.25 0 0 1 11.75 12h-1.312c.1.128.21.248.328.36a.75.75 0 0 1 .234.545v.345a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-.345a.75.75 0 0 1 .234-.545c.118-.111.228-.232.328-.36H4.25A2.25 2.25 0 0 1 2 9.75v-5.5Zm2.25-.75a.75.75 0 0 0-.75.75v4.5c0 .414.336.75.75.75h7.5a.75.75 0 0 0 .75-.75v-4.5a.75.75 0 0 0-.75-.75h-7.5Z" clip-rule="evenodd"/></svg>
      </button>
      <button class="theme-pill-btn" data-for-theme="light" title="Light theme" role="radio" aria-label="Light theme">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 1a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 8 1ZM10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0ZM12.95 4.11a.75.75 0 1 0-1.06-1.06l-1.062 1.06a.75.75 0 0 0 1.061 1.062l1.06-1.061ZM15 8a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 15 8ZM11.89 12.95a.75.75 0 0 0 1.06-1.06l-1.06-1.062a.75.75 0 0 0-1.062 1.061l1.061 1.06ZM8 12a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-1.5 0v-1.5A.75.75 0 0 1 8 12ZM5.172 11.89a.75.75 0 0 0-1.061-1.062L3.05 11.89a.75.75 0 1 0 1.06 1.06l1.06-1.06ZM4 8a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1 0-1.5h1.5A.75.75 0 0 1 4 8ZM4.11 5.172A.75.75 0 0 0 5.173 4.11L4.11 3.05a.75.75 0 1 0-1.06 1.06l1.06 1.06Z"/></svg>
      </button>
      <button class="theme-pill-btn" data-for-theme="dark" title="Dark theme" role="radio" aria-label="Dark theme">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M14.438 10.148c.19-.425-.321-.787-.748-.601A5.5 5.5 0 0 1 6.453 2.31c.186-.427-.176-.938-.6-.748a6.501 6.501 0 1 0 8.585 8.586Z"/></svg>
      </button>
    </div>
    <button class="btn" id="shareBtn" style="display:none">Share</button>
    <button class="btn btn-primary" id="finishBtn">Finish Review</button>
  </div>
</div>

<div id="toc" class="toc toc-hidden">
  <div class="toc-header">
    <span>Contents</span>
    <button class="toc-close" title="Close table of contents" aria-label="Close table of contents">&#x2715;</button>
  </div>
  <ul class="toc-list"></ul>
</div>

<div class="toast-container" id="toastContainer"></div>
<div class="bottom-toast-container" id="bottomToastContainer"></div>

<div class="main-layout">
  <div class="file-tree-panel" id="fileTreePanel">
    <div class="file-tree-header">
      <span class="file-tree-title">Files</span>
      <span class="file-tree-stats" id="fileTreeStats"></span>
    </div>
    <div class="file-tree-body" id="fileTreeBody"></div>
  </div>
  <div class="main-content">
    <div id="filesContainer">
      <div class="loading" style="padding: 40px; text-align: center; color: var(--fg-muted);">Loading...</div>
    </div>
  </div>
</div>

<div class="waiting-overlay" id="waitingOverlay">
  <div class="waiting-dialog">
    <div class="waiting-spinner"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
    <h3>Review Complete</h3>
    <p id="waitingMessage"></p>
    <p class="waiting-edits" id="waitingEdits"></p>
    <div class="waiting-prompt" id="waitingPrompt"></div>
    <p style="font-size: 12px; color: var(--fg-muted); margin-top: 8px;" id="waitingClipboard"></p>
    <button class="btn btn-sm" id="backToEditing" style="margin-top: 16px;">Back to editing</button>
  </div>
</div>

<div class="shortcuts-overlay" id="shortcutsOverlay">
  <div class="shortcuts-dialog">
    <h3>Keyboard Shortcuts</h3>
    <table class="shortcuts-table">
      <tr><td><kbd>j</kbd></td><td>Next block</td></tr>
      <tr><td><kbd>k</kbd></td><td>Previous block</td></tr>
      <tr><td><kbd>c</kbd></td><td>Comment on focused block</td></tr>
      <tr><td><kbd>e</kbd></td><td>Edit comment on focused block</td></tr>
      <tr><td><kbd>d</kbd></td><td>Delete comment on focused block</td></tr>
      <tr><td><kbd>v</kbd></td><td>Toggle viewed on focused file</td></tr>
      <tr><td><kbd>Shift</kbd>+<kbd>F</kbd></td><td>Finish review</td></tr>
      <tr><td><kbd>t</kbd></td><td>Toggle table of contents</td></tr>
      <tr><td><kbd>Esc</kbd></td><td>Cancel / clear focus</td></tr>
      <tr><td><kbd>Ctrl</kbd>+<kbd>Enter</kbd></td><td>Submit comment</td></tr>
      <tr><td><kbd>?</kbd></td><td>Toggle this help</td></tr>
    </table>
  </div>
</div>

<script src="markdown-it.min.js"></script>
<script src="highlight.min.js"></script>
<script src="hljs-javascript.min.js"></script>
<script src="hljs-typescript.min.js"></script>
<script src="hljs-go.min.js"></script>
<script src="hljs-python.min.js"></script>
<script src="hljs-ruby.min.js"></script>
<script src="hljs-rust.min.js"></script>
<script src="hljs-sql.min.js"></script>
<script src="hljs-bash.min.js"></script>
<script src="hljs-json.min.js"></script>
<script src="hljs-yaml.min.js"></script>
<script src="hljs-xml.min.js"></script>
<script src="hljs-css.min.js"></script>
<script src="hljs-elixir.min.js"></script>
<script src="mermaid.min.js"></script>
<script src="app.js"></script>
</body>
</html>
